!function(n){n.fn.vitGallery=function(t){function i(n){R=N.find("."+K.controlsClass),A=N.find(".gallery__block"),T=N.find(".prev"),M=N.find(".next"),D=N.find(".gallery__thumbnail").length>0?N.find(".gallery__thumbnail"):N.find(".gallery__controls__item"),H=N.find(".gallery__inner"),B=H.find(".gallery__img-block.current"),P=O.find(".gallery__description-block__description"),j=B.index()}function e(){B=H.find(".gallery__img-block.current"),j=B.index(),P=O.find(".gallery__description-block__description"),Q=n("."+Z).find(".current"),"thumbnails"==K.controls&&(E=parseInt(z.css("left")))}function a(){O.each(function(){n(this).find("span").addClass("gallery__description-block__description"),n(this).find("img").addClass("gallery__img-block__img")}),i()}function s(){O.wrapAll('<div class="gallery__block"><div class="'+U+'"></div></div>'),i()}function l(){var t=0;return K.imgPadding&&0!=K.imgPadding&&(t=(O.length-1)*K.imgPadding),O.each(function(){t+=n(this).outerWidth()}),i(),t}function r(){var n=N.find("."+U);n.css("width",l()),i()}function o(){O.css("width",N.width()),i("setImgBlockWidth")}function d(){O.each(function(){var t=n(this).find(".gallery__img-block__img");n(this).addClass("load"),t.bindImageLoad(function(){var t=n(this);setTimeout(function(){t.parent().removeClass("load"),t=null},100)})}),i("setGalleryHeight")}function c(){var t='<span class="prev"></span>',i='<span class="next"></span>',e='<div class="gallery__controls-buttons"></div>',a=A.append(n(e));a.find(".gallery__controls-buttons").append(n(t)).append(n(i))}function u(){var t=n("body"),i='<span class="'+nn+'"></span>',e='<div class="'+$+" fullscreen_"+N.attr("class")+'"></div>',a='<span class="'+tn+'"></span>',s='<div class="gallery__fake"></div>',l='<div class="gallery__fullscreen__controls"><span class="prev"></span><span class="next"></span></div>';A.append(i),N.append(e),F=t.find(".fullscreen_"+N.attr("class")).append(a),F.append(s),F.append(l);F.find("."+K.controlsClass).addClass("fullscreen")}function f(){var n=B.find("img").attr("src");F.append('<img src="'+n+'" class="gallery__fullscreen__img">')}function h(t,i){var e=F.find(".gallery__fullscreen__img");switch(t){case"next":var a=B.next().find("img").attr("src");e.attr("src",a);break;case"prev":var s=B.prev().find("img").attr("src");e.attr("src",s);break;case"goTo":var l=n(".gallery__img-block").eq(i).find("img").attr("src");e.attr("src",l)}}function m(){if(K.controls){R=N.find("."+K.controlsClass);for(var t='<li class="gallery__controls__item"></li>',e=0;O.length>e;e++)var a=R.append(t);n(".gallery__controls__item").each(function(t){n(this).addClass("item_"+t)}),R.append(a);n(a).find("li").wrapAll('<ul class="gallery__controls__ul"></ul>')}i("createControls")}function p(){var t,e='<div class="gallery__controls__inner"></div>',a='<div class="gallery__controls__thumbnails-ul"></div>';if(K.controls){R=N.find("."+K.controlsClass);var s=R.append(a);s.find(".gallery__controls__thumbnails-ul").append(e),G=s.find(".gallery__controls__thumbnails-ul"),z=n(".gallery__controls__inner"),O.each(function(){var i=n(this).find("img"),e=i.attr("thumb-url");t=document.createElement("img"),t.src=e,n(t).css("width","100%"),z.append(n(t))}),z.find("img").wrap('<span class="'+Y+'"></span>'),n("."+Y).width(K.thumnailWidth).height(K.thumnaiHeight).css("margin-right",K.thumbnailMargin).attr("data-index",n(this).index()).last().css("margin-right",0),n("."+Y).append("<i></i>"),z.css({width:(n("."+Y).outerWidth()+K.thumbnailMargin)*n("."+Y).length-K.thumbnailMargin,left:0}),i("createThumbnails")}}function _(){var t=G.outerWidth(),i=n(".gallery__thumbnail"),e=i.outerWidth(),a=Math.round(t/e)/2;a=Math.round(a),L=i.eq(a-1),L.addClass("center")}function g(){A.append('<div class="'+V+'"></div>'),P.each(function(){n("."+V).append(n(this))}),P.eq(j).addClass("current"),i("createDescription")}function v(n,t){P=N.find(".gallery__description-block__description"),P.eq(n).removeClass("current"),P.eq(t).addClass("current")}function y(){O.each(function(t){0!=t&&n(this).css("display","inline-block")}),i("showImg")}function b(t,i){switch(t){case"next":D.eq(i).find("i").css({left:"auto",width:"100%"}).animate({width:0},K.thumbnailAnimationSpeed,function(){n(this).css({left:"",width:""})}),D.eq(i+1).find("i").css({right:"auto",width:"0"}).animate({width:"100%"},K.thumbnailAnimationSpeed,function(){n(this).css({right:"",width:""})});break;case"prev":D.eq(i).find("i").css({right:"auto",width:"100%"}).animate({width:"0"},K.thumbnailAnimationSpeed,function(){n(this).css({right:"",width:""})}),D.eq(i-1).find("i").css({left:"auto",width:"0"}).animate({width:"100%"},K.thumbnailAnimationSpeed,function(){n(this).css({left:"",width:""})})}}function C(n){return B.is(":last-child")||("slide"==K.transition?(H.animate({left:X-O.width()},K.animateSpeed),X-=O.width()):"crossfade"==K.transition?(B.animate({opacity:0},150),B.animate({opacity:1},150)):"slide-blur"==K.transition&&(H.animate({left:X-O.width()},K.animateSpeed,function(){O.removeClass("do-transition")}),X-=O.width(),B.addClass("do-transition").next().addClass("do-transition"),B.animate({opacity:1},150)),K.fullscreen&&h("next"),B.removeClass("current"),B.next().addClass("current"),D.eq(j).removeClass("current"),D.eq(j+1).addClass("current"),K.thumbnailAnimation&&b("next",j),K.autoplay&&(clearInterval(J),q()),v(j,j+1),e(),S(),n&&n(),x(j)),j}function w(n){if(!B.is(":first-child")){if("slide"==K.transition?(H.animate({left:X+O.width()},K.animateSpeed),X+=O.width()):"crossfade"==K.transition?(B.animate({opacity:0},150),B.animate({opacity:1},150)):"slide-blur"==K.transition&&(H.animate({left:X+O.width()},K.animateSpeed,function(){O.removeClass("do-transition")}),X+=O.width(),B.addClass("do-transition").prev().addClass("do-transition"),B.animate({opacity:1},150)),K.fullscreen&&h("prev"),B.removeClass("current"),B.prev().addClass("current"),D.eq(j).removeClass("current"),D.eq(j-1).addClass("current"),K.thumbnailAnimation&&b("prev",j),K.autoplay&&(clearInterval(J),q()),v(j,j-1),e(),S(),"thumbnails"==K.controls){G.offset().left,D.first().offset().left}n&&n(),x(j)}}function k(n){"slide"==K.transition?j<n?(H.animate({left:X-O.width()*(n-j)},K.animateSpeed),X-=O.width()*(n-j)):(H.animate({left:-(O.width()*(n+j)+X)},K.animateSpeed),X=-(O.width()*(n+j)+X)):"crossfade"==K.transition?(H.find(".current").animate({opacity:0},150),H.find(".current").animate({opacity:1},150)):"slide-blur"==K.transition&&(j<n?(H.animate({left:X-O.width()*(n-j)},K.animateSpeed,function(){O.removeClass("do-transition")}),O.addClass("do-transition"),X-=O.width()*(n-j)):(H.animate({left:-(O.width()*(n+j)+X)},K.animateSpeed,function(){O.removeClass("do-transition")}),O.addClass("do-transition"),X=-(O.width()*(n+j)+X))),v(H.find(".current").index(),n),H.find(".current").removeClass("current"),O.eq(n).addClass("current"),K.thumbnailAnimation&&(R.find(".current").find("i").css({width:"",left:"",right:""}),j-n==-1?b("next",j):j-n==1&&b("prev",j)),R.find(".current").removeClass("current"),D.eq(n).addClass("current"),S(),e(),K.autoplay&&(clearInterval(J),q()),K.fullscreen&&h("goTo",H.find(".current").index()),x(j)}function x(n){D.length;n==D.length-1?N.find(".next").addClass("hide"):N.find(".next").removeClass("hide"),0==n?N.find(".prev").addClass("hide"):N.find(".prev").removeClass("hide")}function q(){var n=O.length;J=setInterval(function(){(j+1)/n==1&&(clearInterval(J),setTimeout(function(){k(0)},K.autoplayDelay/2)),C()},K.autoplayDelay)}function W(){X=parseInt(H.css("left")),j=B.index();var t=0;if(T.on("click",function(){n(this).hasClass("hide")||(t++,B=H.find(".gallery__img-block.current"),w())}),M.on("click",function(){n(this).hasClass("hide")||(B=H.find(".gallery__img-block.current"),C())}),D.on("click",function(){k(n(this).index())}),K.fullscreen){var i=N.find("."+nn),a=n(".fullscreen_"+N.attr("class")).find("."+tn);i.on("click",function(){F.addClass("open"),R.appendTo(F),"thumbnails"==K.controls&&(n(".gallery__thumbnail.center").removeClass("center"),_()),f()}),a.on("click",function(){F.removeClass("open"),R.appendTo(N),"thumbnails"==K.controls&&(n(".gallery__thumbnail.center").removeClass("center"),_()),S(),F.find(".gallery__fullscreen__img").remove()})}"thumbnails"==K.controls&&z.on("mousedown",function(t){var i,e=t.pageX,a=z.css("left");n(this).offset().left,n(this).offset().left+n(this).outerWidth();n(window).on("mousemove",function(n){var t=e-n.pageX,s=n.pageX;!function(){setTimeout(function(){i=n.pageX},50)}(),s>i&&z.css("left",parseInt(a)-t),s<i&&z.css("left",parseInt(a)-t),n.preventDefault()}).on("mouseup",function(t){t.preventDefault(),z.offset().left>=z.parent().offset().left&&(z.addClass("go-back").css("left",0),setTimeout(function(){z.removeClass("go-back")},300)),z.offset().left+z.outerWidth()<=z.parent().offset().left+z.parent().outerWidth()&&(z.addClass("go-back").css("left",z.parent().outerWidth()-z.outerWidth()),setTimeout(function(){z.removeClass("go-back")},300)),n(this).unbind("mousemove")}),t.preventDefault()}),n(window).on("resize",function(){K.autoplay&&clearInterval(J),d(),o(),r(),e(),H.css("left",-(j*B.width())),X=-(j*B.width()),K.autoplay&&q()})}function S(){var n=0;if(N.find(".current").length>0){if(n=N.find(".current").index(),"thumbnails"==K.controls){var t=D.eq(n).offset().left+(D.outerWidth()+K.thumbnailMargin)/2,a=L.offset().left+(D.outerWidth()+K.thumbnailMargin)/2;D.eq(n).index()>L.index()-1&&D.eq(n).index()<=D.length-L.index()-2&&z.animate({left:-(t-a)},300)}D.eq(n).addClass("current"),H.css("left",-(n*O.width()))}else O.first().addClass("current"),D.first().addClass("current");return i("getCurrentSlide"),e(),n}function I(){a(),s(),c(),d(),o(),r(),y(),"points"==K.controls?m():"thumbnails"==K.controls&&(p(),_()),K.fullscreen&&u(),S(),K.description&&g(),W(),K.autoplay&&q()}var A,T,M,D,H,P,X,B,j,G,L,Q,z,E,F,J,K=n.extend({debag:!1,galleryHeight:"auto",imgBlockClass:"gallery__img-block",controls:"thumbnails",controlsClass:"gallery__controls",thumnailWidth:90,thumnaiHeight:60,thumbnailMargin:5,thumbnailAnimation:!0,thumnailAnimationSpeed:1e3,animateSpeed:1e3,description:!0,imgPadding:15,autoplay:!1,autoplayDelay:3e3,fullscreen:!1,transition:"slide"},t),N=n(this),O=N.find("."+K.imgBlockClass),R=N.find("."+K.controlsClass),U="gallery__inner",V="gallery__description-block",Y="gallery__thumbnail",Z="gallery__controls",$="gallery__fullscreen__wrap",nn="gallery__fullscreen__bt",tn="gallery__fullscreen__exit";I()}}(jQuery),function(n){n.fn.bindImageLoad=function(t){function i(n){return!!n.complete&&("undefined"==typeof n.naturalWidth||0!==n.naturalWidth)}return this.each(function(){var e=n(this);e.is("img")&&n.isFunction(t)&&(e.one("load",t),i(this)&&e.trigger("load"))})}}(jQuery);